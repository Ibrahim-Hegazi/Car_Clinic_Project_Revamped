# 🚗 Car Clinic Smart Repair Advisor

A complete offline-ready pipeline to turn Reddit car-related conversations into a smart emergency chatbot and mechanic-assistant capable of diagnosing problems, suggesting solutions, and recommending the nearest viable branch.

---

## 📌 Project Goal

Create a fully autonomous system that:
- Extracts and cleans car repair issues from Reddit using LLMs.
- Tags and embeds cleaned data for semantic search and similarity matching.
- Powers an offline chatbot that provides solutions **and** recommends the nearest suitable Car Clinic branch.

---

## 🧠 Full Roadmap

### ✅ Phase 1: Reddit Data Extraction
- Fetch raw Reddit posts + comments using `PRAW` & `HTTPX`.
- Handle pagination & API limits.
- Store raw data in `/data/raw/`.
- Integrated with GitHub Actions.

### 🔍 Phase 2: Reddit Data Cleaning (LLM-Based)
**Goal**: Extract structured `problem → solution` pairs using an offline LLM.

**Steps:**
- Preprocessing (remove bots, deduplicate, ensure valid comments)
- Offline LLM Inference (DeepSeek or similar) using custom JSON prompt.
- Postprocessing (hallucination stripping, format check)
- Output to `/data/cleaned/`

### 🏷️ Phase 3: Tag Generation
- Extract `problem_tags` & `solution_tags` using keyword + LLM prompts.
- Store in `/data/tagged/` with confidence scores.

### 🔢 Phase 4: Embedding Generation
- Create embeddings for both Reddit posts and Car Clinic branches.
- Use SBERT or Instructor-XL.
- Store in `/data/embeddings/problems/` and `/data/embeddings/branches/`.

### 🧭 Phase 5: Recommender System
- Match user problem to branch using:
  - Tag-based scoring
  - Embedding similarity (cosine)
  - Filters: location, availability
- Rank top-N branch results.

### 🧪 Phase 6: Local & Integrated Testing
- Unit tests for each phase.
- End-to-end runs on small batches.
- Visual inspection of tags/embeddings/matches.

### 🔄 Phase 7: Prefect Orchestration
- Convert all `flow.py` scripts into Prefect workflows.
- Add logging, retries, chaining:
  `extractor → cleaner → tagger → embedder → recommender`

### ☁️ Phase 8: GitHub Actions & Deployment
- Schedule daily runs via GitHub Actions.
- Dockerization-ready for future server or edge deployment.

### 📘 Phase 9: Documentation & Finalization
- All module docs go in `/docs/`.
- Record model/prompt choices.
- Sample data & diagrams.

### 💬 Phase 10: Emergency Chatbot System
- Final offline LLM chatbot trained on cleaned Reddit data.
- Input: "My car engine stalls at stoplights"
- Output: Suggested solution + nearest branch (reasoned match)

### 🛠️ Phase 11: Backend Integration & APIs
- FastAPI backend:
  - `/recommend` → Accepts a problem, returns a solution + branch
  - `/chatbot` → Emergency assistant mode
- CI/CD & Prefect CLI scripts

---

## 🗃️ File Structure (Key Directories)

```
car_clinic_project/
│
├── data/
│   ├── raw/
│   ├── cleaned/
│   ├── tagged/
│   └── embeddings/
│
├── extractor/
│   └── extractor.py, flow.py
│
├── cleaner/
│   ├── preprocessor.py
│   ├── llm_runner.py
│   ├── postprocessor.py
│   └── flow.py
│
├── tag_generator/
│   └── tagger.py, flow.py
│
├── embedding_generator/
│   └── embedder.py, flow.py
│
├── recommender/
│   ├── matcher.py, ranker.py, flow.py
│   └── api.py (FastAPI endpoints)
│
├── chatbot/
│   └── chatbot_engine.py
│
├── prefect_flows/
│   └── master_flow.py
│
├── docs/
│   └── architecture.png, samples/, prompt_docs.md
```

---

## 🧠 Sample Prompt Template for LLM Inference

```
### Task:
Given the Reddit post and top comment below, extract a car problem and its suggested solution.
Your output must be a JSON with exactly two fields: "problem" and "solution".

### Context:
Title: My car won’t start after rain  
Body: Whenever it rains, my car refuses to start. Battery looks fine.  
Comment: Sounds like moisture is affecting your ignition system. Check distributor cap.

### Return Format:
{
  "problem": "...",
  "solution": "..."
}

If no useful data is found, return:
{ "problem": null, "solution": null }
```

---

## 🏁 Final Output Capabilities

✅ Problem → Solution extraction  
✅ Smart semantic tag generation  
✅ Nearest viable branch recommendation  
✅ Chatbot ready for mechanics & users  
✅ Offline, open-source, scalable

---

## 👨‍🔧 Maintained by
Team Eagles – Ibrahim Hegazi and contributors