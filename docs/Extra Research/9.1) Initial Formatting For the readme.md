# ğŸš— Car Clinic Smart Repair Advisor

A complete offline-ready pipeline to turn Reddit car-related conversations into a smart emergency chatbot and mechanic-assistant capable of diagnosing problems, suggesting solutions, and recommending the nearest viable branch.

---

## ğŸ“Œ Project Goal

Create a fully autonomous system that:
- Extracts and cleans car repair issues from Reddit using LLMs.
- Tags and embeds cleaned data for semantic search and similarity matching.
- Powers an offline chatbot that provides solutions **and** recommends the nearest suitable Car Clinic branch.

---

## ğŸ§  Full Roadmap

### âœ… Phase 1: Reddit Data Extraction
- Fetch raw Reddit posts + comments using `PRAW` & `HTTPX`.
- Handle pagination & API limits.
- Store raw data in `/data/raw/`.
- Integrated with GitHub Actions.

### ğŸ” Phase 2: Reddit Data Cleaning (LLM-Based)
**Goal**: Extract structured `problem â†’ solution` pairs using an offline LLM.

**Steps:**
- Preprocessing (remove bots, deduplicate, ensure valid comments)
- Offline LLM Inference (DeepSeek or similar) using custom JSON prompt.
- Postprocessing (hallucination stripping, format check)
- Output to `/data/cleaned/`

### ğŸ·ï¸ Phase 3: Tag Generation
- Extract `problem_tags` & `solution_tags` using keyword + LLM prompts.
- Store in `/data/tagged/` with confidence scores.

### ğŸ”¢ Phase 4: Embedding Generation
- Create embeddings for both Reddit posts and Car Clinic branches.
- Use SBERT or Instructor-XL.
- Store in `/data/embeddings/problems/` and `/data/embeddings/branches/`.

### ğŸ§­ Phase 5: Recommender System
- Match user problem to branch using:
  - Tag-based scoring
  - Embedding similarity (cosine)
  - Filters: location, availability
- Rank top-N branch results.

### ğŸ§ª Phase 6: Local & Integrated Testing
- Unit tests for each phase.
- End-to-end runs on small batches.
- Visual inspection of tags/embeddings/matches.

### ğŸ”„ Phase 7: Prefect Orchestration
- Convert all `flow.py` scripts into Prefect workflows.
- Add logging, retries, chaining:
  `extractor â†’ cleaner â†’ tagger â†’ embedder â†’ recommender`

### â˜ï¸ Phase 8: GitHub Actions & Deployment
- Schedule daily runs via GitHub Actions.
- Dockerization-ready for future server or edge deployment.

### ğŸ“˜ Phase 9: Documentation & Finalization
- All module docs go in `/docs/`.
- Record model/prompt choices.
- Sample data & diagrams.

### ğŸ’¬ Phase 10: Emergency Chatbot System
- Final offline LLM chatbot trained on cleaned Reddit data.
- Input: "My car engine stalls at stoplights"
- Output: Suggested solution + nearest branch (reasoned match)

### ğŸ› ï¸ Phase 11: Backend Integration & APIs
- FastAPI backend:
  - `/recommend` â†’ Accepts a problem, returns a solution + branch
  - `/chatbot` â†’ Emergency assistant mode
- CI/CD & Prefect CLI scripts

---

## ğŸ—ƒï¸ File Structure (Key Directories)

```
car_clinic_project/
â”‚
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ raw/
â”‚   â”œâ”€â”€ cleaned/
â”‚   â”œâ”€â”€ tagged/
â”‚   â””â”€â”€ embeddings/
â”‚
â”œâ”€â”€ extractor/
â”‚   â””â”€â”€ extractor.py, flow.py
â”‚
â”œâ”€â”€ cleaner/
â”‚   â”œâ”€â”€ preprocessor.py
â”‚   â”œâ”€â”€ llm_runner.py
â”‚   â”œâ”€â”€ postprocessor.py
â”‚   â””â”€â”€ flow.py
â”‚
â”œâ”€â”€ tag_generator/
â”‚   â””â”€â”€ tagger.py, flow.py
â”‚
â”œâ”€â”€ embedding_generator/
â”‚   â””â”€â”€ embedder.py, flow.py
â”‚
â”œâ”€â”€ recommender/
â”‚   â”œâ”€â”€ matcher.py, ranker.py, flow.py
â”‚   â””â”€â”€ api.py (FastAPI endpoints)
â”‚
â”œâ”€â”€ chatbot/
â”‚   â””â”€â”€ chatbot_engine.py
â”‚
â”œâ”€â”€ prefect_flows/
â”‚   â””â”€â”€ master_flow.py
â”‚
â”œâ”€â”€ docs/
â”‚   â””â”€â”€ architecture.png, samples/, prompt_docs.md
```

---

## ğŸ§  Sample Prompt Template for LLM Inference

```
### Task:
Given the Reddit post and top comment below, extract a car problem and its suggested solution.
Your output must be a JSON with exactly two fields: "problem" and "solution".

### Context:
Title: My car wonâ€™t start after rain  
Body: Whenever it rains, my car refuses to start. Battery looks fine.  
Comment: Sounds like moisture is affecting your ignition system. Check distributor cap.

### Return Format:
{
  "problem": "...",
  "solution": "..."
}

If no useful data is found, return:
{ "problem": null, "solution": null }
```

---

## ğŸ Final Output Capabilities

âœ… Problem â†’ Solution extraction  
âœ… Smart semantic tag generation  
âœ… Nearest viable branch recommendation  
âœ… Chatbot ready for mechanics & users  
âœ… Offline, open-source, scalable

---

## ğŸ‘¨â€ğŸ”§ Maintained by
Team Eagles â€“ Ibrahim Hegazi and contributors